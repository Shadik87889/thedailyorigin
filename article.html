<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Title will be set dynamically -->
    <title>The Daily Origin</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap"
      rel="stylesheet"
    />

    <!-- NEW: Google Fonts for Logo -->
    <link
      href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap"
      rel="stylesheet"
    />

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Custom Styles (Reused for consistency) -->
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #020617; /* slate-950 */
        color: #d1d5db; /* gray-300 */
        overflow-x: hidden;
      }
      .header-glass {
        background-color: rgba(2, 6, 23, 0.6);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-bottom: 1px solid #1e293b;
      }
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #0f172a;
      }
      ::-webkit-scrollbar-thumb {
        background: #0891b2;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #22d3ee;
      }

      /* NEW: Logo Font Styles */
      .logo-artisan {
        font-family: "Caveat", cursive;
      }
      .logo-main {
        font-family: "Oswald", sans-serif;
        font-weight: 700;
      }

      /* Loading Spinner */
      #loading-spinner {
        border: 4px solid #1e293b;
        border-top: 4px solid #22d3ee;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Gradient text */
      .text-gradient {
        background: linear-gradient(to right, #22d3ee, #60a5fa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        text-fill-color: transparent;
      }

      /* Premium Section Title Style (for related) */
      .section-title {
        position: relative;
        padding-bottom: 0.75rem;
        margin-bottom: 2rem;
        border-bottom: 1px solid #1e293b;
      }
      .section-title::after {
        content: "";
        position: absolute;
        bottom: -1px;
        left: 0;
        width: 100px;
        height: 2px;
        background: linear-gradient(to right, #22d3ee, #0891b2);
      }

      /* --- NEW: Smooth scroll behavior --- */
      html {
        scroll-behavior: smooth;
      }

      /* Article content styling */
      .article-content h2 {
        font-size: 1.875rem; /* text-3xl */
        font-weight: 800; /* extra-bold */
        color: white;
        margin-top: 2.5rem; /* mt-10 */
        margin-bottom: 1rem; /* mb-4 */
        border-left: 3px solid #0891b2; /* border-l-4 border-cyan-700 */
        padding-left: 1rem; /* pl-4 */
      }
      .article-content p {
        font-size: 1.125rem; /* text-lg */
        line-height: 1.75; /* leading-relaxed */
        color: #d1d5db; /* text-gray-300 */
        margin-bottom: 1.5rem; /* mb-6 */
      }
      .article-content strong {
        color: #f8fafc; /* text-slate-50 */
        font-weight: 700;
      }
      .article-content blockquote {
        border-left: 4px solid #1e293b; /* border-slate-800 */
        padding-left: 1.5rem; /* pl-6 */
        font-style: italic;
        color: #94a3b8; /* text-slate-400 */
        margin-top: 2rem;
        margin-bottom: 2rem;
        font-size: 1.25rem; /* text-xl */
      }
      /* --- NEW: Added more styles for full body content --- */
      .article-content ul {
        list-style-type: disc;
        padding-left: 2rem;
        margin-bottom: 1.5rem;
        font-size: 1.125rem;
        line-height: 1.75;
      }
      .article-content ol {
        list-style-type: decimal;
        padding-left: 2rem;
        margin-bottom: 1.5rem;
        font-size: 1.125rem;
        line-height: 1.75;
      }
      .article-content li {
        margin-bottom: 0.5rem;
      }
      .article-content a {
        color: #22d3ee; /* cyan-400 */
        text-decoration: underline;
        transition: color 0.2s;
      }
      .article-content a:hover {
        color: #67e8f9; /* cyan-300 */
      }
      .article-content code {
        background: #1e293b; /* slate-800 */
        color: #e2e8f0; /* slate-200 */
        padding: 0.1rem 0.4rem;
        border-radius: 0.25rem;
        font-family: monospace;
      }
      .article-content pre {
        background: #020617; /* slate-950 */
        border: 1px solid #1e293b; /* slate-800 */
        padding: 1rem;
        border-radius: 0.5rem;
        overflow-x: auto;
        margin-bottom: 1.5rem;
      }
      .article-content pre code {
        background: none;
        padding: 0;
      }
      .article-content img {
        width: 100%;
        border-radius: 0.5rem;
        border: 1px solid #1e293b;
        margin-top: 1rem;
        margin-bottom: 1rem;
      }

      /* --- NEW: Premium Desktop Nav Link Hover Effect --- */
      .desktop-nav-link {
        position: relative;
        padding-bottom: 4px; /* Give space for the line */
      }

      .desktop-nav-link::after {
        content: "";
        position: absolute;
        bottom: 0; /* Align to the bottom of the 4px padding */
        left: 0;
        width: 100%;
        height: 2px;
        /* Use the same premium gradient from .text-gradient */
        background: linear-gradient(to right, #22d3ee, #60a5fa);
        transform: scaleX(0);
        transform-origin: left; /* Grow from left to right */
        transition: transform 0.3s cubic-bezier(0.19, 1, 0.22, 1); /* Smoother ease */
      }

      .desktop-nav-link:hover::after {
        transform: scaleX(1);
      }

      /* Make the text slightly brighter on hover, instead of full cyan */
      .desktop-nav-link:hover {
        color: #e5e7eb; /* gray-200 */
      }
      /* --- End of Premium Effect --- */

      /* --- NEW: Advanced Mobile Menu Animations --- */

      /* Set initial state for nav links */
      #mobile-menu nav a {
        opacity: 0;
        transform: translateX(20px);
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
      }

      /* Set "open" state for nav links when menu-open class is added */
      #mobile-menu.menu-open nav a {
        opacity: 1;
        transform: translateX(0);
      }

      /* Staggered delay for links */
      #mobile-menu.menu-open nav a:nth-child(1) {
        transition-delay: 0.1s;
      }
      #mobile-menu.menu-open nav a:nth-child(2) {
        transition-delay: 0.15s;
      }
      #mobile-menu.menu-open nav a:nth-child(3) {
        transition-delay: 0.2s;
      }
      #mobile-menu.menu-open nav a:nth-child(4) {
        transition-delay: 0.25s;
      }
      #mobile-menu.menu-open nav a:nth-child(5) {
        transition-delay: 0.3s;
      }
      #mobile-menu.menu-open nav a:nth-child(6) {
        transition-delay: 0.35s;
      }
      #mobile-menu.menu-open nav a:nth-child(7) {
        transition-delay: 0.4s;
      }

      /* Set initial state for social links */
      #mobile-menu .mobile-social-links {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        transition-delay: 0.5s; /* Fires after the nav links */
      }

      /* Set "open" state for social links */
      #mobile-menu.menu-open .mobile-social-links {
        opacity: 1;
        transform: translateY(0);
      }
      /* --- End of Mobile Menu Animations --- */
    </style>
  </head>
  <body class="antialiased flex flex-col min-h-screen">
    <!-- Loading Overlay -->
    <div
      id="loading-overlay"
      class="fixed inset-0 bg-slate-950 z-50 flex flex-col justify-center items-center"
    >
      <div id="loading-spinner"></div>
      <p class="text-cyan-400 mt-4 text-lg" id="loading-text">
        Loading Article...
      </p>
    </div>

    <!-- Header (Reused) -->
    <header class="header-glass sticky top-0 z-40 w-full">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-20">
          <!-- Logo -->
          <a href="./home.html" class="flex items-baseline space-x-2">
            <span class="text-3xl text-white logo-main">The Daily</span>
            <span class="relative">
              <span class="text-4xl font-bold text-cyan-400 logo-artisan"
                >Origin</span
              >
              <!-- NEW: Handwritten SVG underline -->
              <svg
                class="absolute left-0 w-full h-4 -bottom-1 text-cyan-500"
                viewBox="0 0 100 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                preserveAspectRatio="none"
              >
                <path
                  d="M2 12 C 30 22 70 22 98 12"
                  stroke="currentColor"
                  stroke-width="3"
                  stroke-linecap="round"
                ></path>
              </svg>
              <!-- NEW: Beta Tag -->
              <span
                class="absolute top-0 -right-5 transform -translate-y-1/2 rotate-12 bg-yellow-400 text-yellow-900 text-[10px] font-bold px-1.5 py-0.5 rounded-sm"
              >
                BETA
              </span>
            </span>
          </a>

          <!-- Desktop Navigation -->
          <!-- UPDATED: Added 'desktop-nav-link' class and removed hover:text-cyan-400 -->
          <nav class="hidden md:flex space-x-8">
            <a
              href="./category.html?category=World"
              class="text-sm font-medium text-gray-300 transition-colors desktop-nav-link"
              >World</a
            >
            <a
              href="./category.html?category=Tech"
              class="text-sm font-medium text-gray-300 transition-colors desktop-nav-link"
              >Tech</a
            >
            <a
              href="./category.html?category=Politics"
              class="text-sm font-medium text-gray-300 transition-colors desktop-nav-link"
              >Politics</a
            >
            <a
              href="./category.html?category=Culture"
              class="text-sm font-medium text-gray-300 transition-colors desktop-nav-link"
              >Culture</a
            >
            <a
              href="./category.html?category=Science"
              class="text-sm font-medium text-gray-300 transition-colors desktop-nav-link"
              >Science</a
            >
            <a
              href="./category.html?category=Sports"
              class="text-sm font-medium text-gray-300 transition-colors desktop-nav-link"
              >Sports</a
            >
            <a
              href="./category.html?category=Education"
              class="text-sm font-medium text-gray-300 transition-colors desktop-nav-link"
              >Education</a
            >
          </nav>

          <!-- Search and Mobile Menu Button -->
          <div class="flex items-center space-x-4">
            <button class="text-gray-400 hover:text-cyan-400 transition-colors">
              <i data-lucide="search" class="w-6 h-6"></i>
            </button>
            <!-- UPDATED: Mobile Menu Button markup for icon switching -->
            <button
              class="md:hidden text-gray-400 hover:text-cyan-400 transition-colors"
              id="mobile-menu-btn"
            >
              <i
                data-lucide="menu"
                class="w-6 h-6"
                id="mobile-menu-open-icon"
              ></i>
              <i
                data-lucide="x"
                class="w-6 h-6 hidden"
                id="mobile-menu-close-icon"
              ></i>
            </button>
          </div>
        </div>
      </div>
      <!-- REMOVED: Old Mobile Menu (was here) -->
    </header>

    <!-- NEW: Mobile Menu Overlay -->
    <div
      id="mobile-menu-overlay"
      class="fixed inset-0 bg-black/70 z-40 opacity-0 invisible transition-opacity duration-300 ease-in-out md:hidden"
    ></div>

    <!-- NEW: Advanced Mobile Menu (Slides from right) -->
    <div
      id="mobile-menu"
      class="fixed top-0 right-0 h-full w-80 max-w-full bg-slate-950 z-50 transform translate-x-full transition-transform duration-300 ease-in-out md:hidden shadow-2xl shadow-black flex flex-col"
    >
      <!-- Menu Header (Stays at top) -->
      <div
        class="flex-shrink-0 flex justify-between items-center p-6 border-b border-slate-800"
      >
        <span class="text-xl font-bold text-white">Menu</span>
        <button
          class="text-gray-400 hover:text-cyan-400"
          id="mobile-menu-close-btn"
        >
          <i data-lucide="x" class="w-6 h-6"></i>
        </button>
      </div>

      <!-- Menu Links (Grows to fill space and scrolls if needed) -->
      <nav class="flex-grow flex flex-col p-6 overflow-y-auto">
        <a
          href="./category.html?category=World"
          class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-cyan-400 hover:bg-slate-800 transition-colors border-b border-slate-800"
          >World</a
        >
        <a
          href="./category.html?category=Tech"
          class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-cyan-400 hover:bg-slate-800 transition-colors border-b border-slate-800"
          >Tech</a
        >
        <a
          href="./category.html?category=Politics"
          class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-cyan-400 hover:bg-slate-800 transition-colors border-b border-slate-800"
          >Politics</a
        >
        <a
          href="./category.html?category=Culture"
          class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-cyan-400 hover:bg-slate-800 transition-colors border-b border-slate-800"
          >Culture</a
        >
        <a
          href="./category.html?category=Science"
          class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-cyan-400 hover:bg-slate-800 transition-colors border-b border-slate-800"
          >Science</a
        >
        <a
          href="./category.html?category=Sports"
          class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-cyan-400 hover:bg-slate-800 transition-colors border-b border-slate-800"
          >Sports</a
        >
        <a
          href="./category.html?category=Education"
          class="block px-4 py-3 text-base font-medium text-gray-300 hover:text-cyan-400 hover:bg-slate-800 transition-colors border-b border-slate-800"
          >Education</a
        >
      </nav>

      <!-- NEW: Social Links (Stays at bottom) -->
      <div
        class="flex-shrink-0 p-6 border-t border-slate-800 mobile-social-links"
      >
        <div class="flex space-x-6 justify-center">
          <a
            href="#"
            class="text-gray-400 hover:text-cyan-400 transition-colors"
            aria-label="Twitter"
          >
            <i data-lucide="twitter" class="w-6 h-6"></i>
          </a>
          <a
            href="#"
            class="text-gray-400 hover:text-cyan-400 transition-colors"
            aria-label="Facebook"
          >
            <i data-lucide="facebook" class="w-6 h-6"></i>
          </a>
          <a
            href="#"
            class="text-gray-400 hover:text-cyan-400 transition-colors"
            aria-label="Instagram"
          >
            <i data-lucide="instagram" class="w-6 h-6"></i>
          </a>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <main
      class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12 flex-grow"
    >
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 lg:gap-16">
        <!-- Article Content (col-span-2) -->
        <article class="lg:col-span-2">
          <!-- Article Header -->
          <header id="article-header" class="mb-8">
            <!-- Category -->
            <a
              href="#"
              id="article-category-link"
              class="text-gradient text-lg font-bold uppercase tracking-wider hover:brightness-125 transition"
            >
              Loading...
            </a>

            <!-- Title -->
            <h1
              id="article-title"
              class="text-4xl md:text-6xl font-black text-white tracking-tight my-4"
            >
              Loading Article Title...
            </h1>

            <!-- Meta -->
            <div class="flex items-center space-x-4 text-sm text-gray-400">
              <!-- UPDATED: This is now a container for the dynamic byline -->
              <div id="author-byline-container" class="inline-block">
                <span id="article-author">By Inflexion Staff</span>
                <!-- Placeholder author -->
              </div>
              <span>&bull;</span>
              <span id="article-date">Loading date...</span>
            </div>
          </header>

          <!-- Hero Image -->
          <figure class="mb-8">
            <img
              id="article-image"
              src="https://placehold.co/1200x700/0f172a/1e293b?text=Loading+Image..."
              alt="Article hero image"
              class="w-full h-[300px] md:h-[400px] lg:h-[500px] object-cover rounded-lg border border-slate-800"
            />
            <figcaption
              class="text-center text-sm text-gray-500 mt-2"
              id="article-image-caption"
            >
              Placeholder caption.
            </figcaption>
          </figure>

          <!-- Article Body -->
          <div id="article-content-body" class="article-content">
            <!-- Dynamic content will be injected here -->
            <p class="text-2xl font-medium text-gray-200 leading-relaxed">
              Loading content...
            </p>
          </div>

          <!-- Error Message -->
          <div id="article-error" class="hidden text-center py-16">
            <p class="text-2xl font-bold text-gray-400">Article Not Found</p>
            <p class="text-gray-500 mt-2">
              This article may have been moved or deleted.
            </p>
            <a
              href="./home.html"
              class="mt-6 inline-block bg-cyan-500 hover:bg-cyan-400 text-slate-900 font-bold py-2 px-6 rounded-lg transition-colors"
            >
              Back to Home
            </a>
          </div>

          <!-- NEW: Author Bio Box -->
          <div
            id="author-bio-box"
            class="hidden mt-12 p-6 bg-slate-900 border border-slate-800 rounded-lg flex items-start sm:items-center space-x-4 sm:space-x-6"
          >
            <!-- Author Image -->
            <img
              id="author-bio-image"
              src="https://placehold.co/80x80/0f172a/334155?text=Auth"
              alt="Author"
              class="w-16 h-16 sm:w-20 sm:h-20 rounded-full object-cover flex-shrink-0"
            />
            <!-- Author Info -->
            <div>
              <h3
                class="text-xs font-semibold text-gray-400 uppercase tracking-wider"
              >
                About the Author
              </h3>
              <h2
                id="author-bio-name"
                class="text-xl font-bold text-white mt-1"
              >
                Loading...
              </h2>
              <p id="author-bio-text" class="text-sm text-gray-300 mt-2">
                Loading bio...
              </p>
            </div>
          </div>
        </article>

        <!-- Sidebar (col-span-1) -->
        <aside class="space-y-12">
          <!-- Related Stories Section -->
          <section id="related-section">
            <h2 class="text-2xl font-bold text-white section-title">
              Related Stories
            </h2>
            <div id="related-articles-list" class="space-y-6">
              <!-- Related articles will be injected by JS -->
              <p class="text-gray-500" id="related-loading">
                Loading related stories...
              </p>
            </div>
          </section>
        </aside>
      </div>
    </main>

    <!-- Footer (Reused) -->
    <footer class="bg-slate-900 border-t border-slate-800 mt-16">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-8">
          <!-- Logo & About -->
          <div class="col-span-2 lg:col-span-2">
            <a href="./home.html" class="flex items-baseline space-x-2 mb-4">
              <span class="text-2xl text-white logo-main">The Daily</span>
              <span class="relative">
                <span class="text-3xl font-bold text-cyan-400 logo-artisan"
                  >Origin</span
                >
                <!-- NEW: Handwritten SVG underline (slightly smaller) -->
                <svg
                  class="absolute left-0 w-full h-3 -bottom-1 text-cyan-500"
                  viewBox="0 0 100 20"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  preserveAspectRatio="none"
                >
                  <path
                    d="M2 12 C 30 22 70 22 98 12"
                    stroke="currentColor"
                    stroke-width="3"
                    stroke-linecap="round"
                  ></path>
                </svg>
                <!-- NEW: Beta Tag -->
                <span
                  class="absolute top-0 -right-4 transform -translate-y-1/2 rotate-12 bg-yellow-400 text-yellow-900 text-[9px] font-bold px-1.5 py-0.5 rounded-sm"
                >
                  BETA
                </span>
              </span>
            </a>
            <p class="text-sm text-gray-400 max-w-xs">
              The future of information, delivered today. Unbiased, unfiltered,
              and uncompromising.
            </p>
          </div>

          <!-- Quick Links -->
          <div>
            <h3
              class="text-sm font-semibold text-gray-400 uppercase tracking-wider"
            >
              Categories
            </h3>
            <ul class="mt-4 space-y-2">
              <li>
                <a
                  href="./category.html?category=World"
                  class="text-sm text-gray-300 hover:text-cyan-400"
                  >World</a
                >
              </li>
              <li>
                <a
                  href="./category.html?category=Tech"
                  class="text-sm text-gray-300 hover:text-cyan-400"
                  >Tech</a
                >
              </li>
              <li>
                <a
                  href="./category.html?category=Politics"
                  class="text-sm text-gray-300 hover:text-cyan-400"
                  >Politics</a
                >
              </li>
              <li>
                <a
                  href="./category.html?category=Science"
                  class="text-sm text-gray-300 hover:text-cyan-400"
                  >Science</a
                >
              </li>
              <li>
                <a
                  href="./category.html?category=Culture"
                  class="text-sm text-gray-300 hover:text-cyan-400"
                  >Culture</a
                >
                <!-- ADDED Sports and Education -->
              </li>

              <li>
                <a
                  href="./category.html?category=Sports"
                  class="text-sm text-gray-300 hover:text-cyan-400"
                  >Sports</a
                >
              </li>
              <li>
                <a
                  href="./category.html?category=Education"
                  class="text-sm text-gray-300 hover:text-cyan-400"
                  >Education</a
                >
              </li>
            </ul>
          </div>

          <!-- Company -->
          <div>
            <h3
              class="text-sm font-semibold text-gray-400 uppercase tracking-wider"
            >
              Company
            </h3>
            <ul class="mt-4 space-y-2">
              <li>
                <a href="#" class="text-sm text-gray-300 hover:text-cyan-400"
                  >About Us</a
                >
              </li>
              <li>
                <a href="#" class="text-sm text-gray-300 hover:text-cyan-400"
                  >Careers</a
                >
              </li>
              <li>
                <a href="#" class="text-sm text-gray-300 hover:text-cyan-400"
                  >Ethics Policy</a
                >
              </li>
              <li>
                <a href="#" class="text-sm text-gray-300 hover:text-cyan-400"
                  >Contact</a
                >
              </li>
            </ul>
          </div>

          <!-- Legal -->
          <div>
            <h3
              class="text-sm font-semibold text-gray-400 uppercase tracking-wider"
            >
              Legal
            </h3>
            <ul class="mt-4 space-y-2">
              <li>
                <a href="#" class="text-sm text-gray-300 hover:text-cyan-400"
                  >Privacy Policy</a
                >
              </li>
              <li>
                <a href="#" class="text-sm text-gray-300 hover:text-cyan-400"
                  >Terms of Service</a
                >
              </li>
            </ul>
          </div>

          <!-- App -->
          <div>
            <h3
              class="text-sm font-semibold text-gray-400 uppercase tracking-wider"
            >
              Get the App
            </h3>
            <div class="mt-4 space-y-3">
              <a
                href="#"
                class="flex items-center justify-center bg-slate-800 hover:bg-slate-700 text-white py-2 px-3 rounded-lg text-sm"
                ><span>App Store</span></a
              >
              <a
                href="#"
                class="flex items-center justify-center bg-slate-800 hover:bg-slate-700 text-white py-2 px-3 rounded-lg text-sm"
                ><span>Google Play</span></a
              >
            </div>
          </div>
        </div>

        <!-- Bottom Bar -->
        <div
          class="mt-8 border-t border-slate-800 pt-8 flex flex-col md:flex-row justify-between items-center"
        >
          <p class="text-sm text-gray-400">
            &copy; 2025 The Daily Origin. All rights reserved.
          </p>
          <div class="flex space-x-6 mt-4 md:mt-0">
            <a
              href="#"
              class="text-gray-400 hover:text-cyan-400 transition-colors"
              ><i data-lucide="twitter" class="w-5 h-5"></i
            ></a>
            <a
              href="#"
              class="text-gray-400 hover:text-cyan-400 transition-colors"
              ><i data-lucide="facebook" class="w-5 h-5"></i
            ></a>
            <a
              href="#"
              class="text-gray-400 hover:text-cyan-400 transition-colors"
              ><i data-lucide="instagram" class="w-5 h-5"></i
            ></a>
          </div>
        </div>
      </div>
    </footer>

    <!-- Firebase and App Logic -->
    <script type="module">
      // Import Firebase functions
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
      import {
        getFirestore,
        doc,
        getDoc, // <-- NEW: To fetch a single document
        collection,
        onSnapshot,
        query,
        where,
        limit, // <-- NEW: To limit related articles
        Timestamp,
      } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

      // --- Your Provided Firebase Config ---
      const firebaseConfig = {
        apiKey: "AIzaSyCFVD4Ts03OXJ14aJ5h_HGAAuiIg5nme7A",
        authDomain: "edu-env.firebaseapp.com",
        projectId: "edu-env",
        storageBucket: "edu-env.firebasestorage.app",
        messagingSenderId: "259668089849",
        appId: "1:259668089849:web:70a92e04ce3331ed533b28",
        measurementId: "G-VK9WTY47JB",
      };

      // --- Global Variables ---
      let app, db;
      const appId =
        typeof __app_id !== "undefined" ? __app_id : "default-news-app";
      let currentArticleId = null;

      // --- UI Element References ---
      const loadingOverlay = document.getElementById("loading-overlay");
      const loadingText = document.getElementById("loading-text");
      const mobileMenu = document.getElementById("mobile-menu");
      const mobileMenuBtn = document.getElementById("mobile-menu-btn");
      const articleError = document.getElementById("article-error");

      // NEW: Mobile Menu Elements
      const mobileMenuOverlay = document.getElementById("mobile-menu-overlay");
      const mobileMenuOpenIcon = document.getElementById(
        "mobile-menu-open-icon"
      );
      const mobileMenuCloseIcon = document.getElementById(
        "mobile-menu-close-icon"
      );
      const mobileMenuCloseBtn = document.getElementById(
        "mobile-menu-close-btn"
      ); // Button inside the menu

      // Article elements
      const articleCategoryLink = document.getElementById(
        "article-category-link"
      );
      const articleTitle = document.getElementById("article-title");
      const articleDate = document.getElementById("article-date");
      // REMOVED: We now use 'author-byline-container'
      // const articleAuthor = document.getElementById('article-author');
      const articleImage = document.getElementById("article-image");
      const articleImageCaption = document.getElementById(
        "article-image-caption"
      );
      const articleContentBody = document.getElementById(
        "article-content-body"
      );

      // NEW: Author Bio elements
      const authorBioBox = document.getElementById("author-bio-box");
      const authorBioImage = document.getElementById("author-bio-image");
      const authorBioName = document.getElementById("author-bio-name");
      const authorBioText = document.getElementById("author-bio-text");

      // Related articles
      const relatedArticlesList = document.getElementById(
        "related-articles-list"
      );
      const relatedLoading = document.getElementById("related-loading");

      // REMOVED: Old Mobile Menu Toggle
      /*
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        */

      // NEW: Advanced Mobile Menu Functions
      function openMenu() {
        // Show Menu
        mobileMenu.classList.remove("translate-x-full");
        mobileMenu.classList.add("menu-open"); // NEW: Add class to trigger animations

        // Show Overlay
        mobileMenuOverlay.classList.remove("opacity-0", "invisible");

        // Toggle Icons
        mobileMenuOpenIcon.classList.add("hidden");
        mobileMenuCloseIcon.classList.remove("hidden");

        // Prevent Body Scroll
        document.body.style.overflow = "hidden";
      }

      function closeMenu() {
        // Hide Menu
        mobileMenu.classList.add("translate-x-full");
        mobileMenu.classList.remove("menu-open"); // NEW: Remove class

        // Hide Overlay
        mobileMenuOverlay.classList.add("opacity-0", "invisible");

        // Toggle Icons
        mobileMenuOpenIcon.classList.remove("hidden");
        mobileMenuCloseIcon.classList.add("hidden");

        // Restore Body Scroll
        document.body.style.overflow = "";
      }

      // NEW: Mobile Menu Event Listeners
      mobileMenuBtn.addEventListener("click", openMenu);
      mobileMenuCloseBtn.addEventListener("click", closeMenu);
      mobileMenuOverlay.addEventListener("click", closeMenu);

      // --- Helper Functions (Reused) ---
      function formatRelativeTime(date) {
        if (date.toDate) {
          date = date.toDate();
        }
        const now = new Date();
        const seconds = Math.floor((now - date) / 1000);

        // Helper for pluralization
        const pluralize = (value, unit) => {
          const rounded = Math.floor(value);
          return `${rounded} ${unit}${rounded === 1 ? "" : "s"} ago`;
        };

        let interval = seconds / 31536000; // Years
        if (interval >= 1) return pluralize(interval, "year");

        interval = seconds / 2592000; // Months
        if (interval >= 1) return pluralize(interval, "month");

        interval = seconds / 86400; // Days
        if (interval >= 1) return pluralize(interval, "day");

        interval = seconds / 3600; // Hours
        if (interval >= 1) return pluralize(interval, "hour");

        interval = seconds / 60; // Minutes
        if (interval >= 1) return pluralize(interval, "minute");

        // Handle seconds
        if (seconds < 10) return "Just now";
        return pluralize(seconds, "second");
      }

      /**
       * Creates fake "lorem ipsum" body content based on the summary.
       * THIS IS NOW A FALLBACK for articles without a 'body' field.
       */
      function generateArticleBody(summary) {
        console.warn("No 'body' field found, generating demo content.");
        // In a real app, you'd have a 'body' field in Firestore.
        // For this demo, we'll create some rich content.
        return `
                <p class="text-2xl font-medium text-gray-200 leading-relaxed">${summary}</p>
                <p>This is a developing story. Inflexion News is actively gathering more information and will provide updates as they become available. The situation remains fluid, and officials are urging the public to rely on verified sources.</p>
                
                <h2>The Core of the Issue</h2>
                <p>At the heart of this development lies a complex web of factors that have been culminating for months. Sources close to the matter indicate that the primary catalyst was a decision made in the early hours of Tuesday morning, a decision that has sent ripples across the industry.</p>
                <blockquote>"We are witnessing a paradigm shift, the likes of which haven't been seen since the dawn of the internet age," one analyst told Inflexion. "The long-term implications are simply staggering."</blockquote>
                
                <h2>What Happens Next?</h2>
                <p>All eyes are now on the upcoming emergency meeting scheduled for this Friday. The outcome of this meeting will likely set the course for the next quarter and could have ramifications that extend far beyond the immediate stakeholders. <strong>Inflexion News</strong> will have live coverage of the event.</p>
                <p>For now, the key players remain tight-lipped, offering only prepared statements that shed little light on their next moves. The uncertainty has led to significant volatility in related markets, a trend that is expected to continue until a clearer picture emerges.</p>
            `;
      }

      /**
       * Creates HTML for a related story (compact sidebar card).
       */
      function createRelatedArticleHTML(article) {
        const timeAgo = article.publishedAt
          ? formatRelativeTime(article.publishedAt)
          : "Just now";
        const articleLink = `./article.html?id=${article.id}`;
        // Use a simple <a> tag wrapper for the whole card
        return `
                <a href="${articleLink}" class="block group bg-slate-900 rounded-lg overflow-hidden border border-slate-800 flex transition-all duration-300 shadow-lg shadow-slate-950/50 hover:border-cyan-600 hover:shadow-2xl hover:shadow-cyan-800/20" aria-label="Read article: ${article.title}">
                    
                    <!-- UPDATED: Image Wrapper Div (w-24 to w-32) -->
                    <div class="w-32 flex-shrink-0"> 
                        <img src="${article.imageUrl}" alt="${article.title}" 
                             onerror="this.src='https://source.unsplash.com/600x400/?news,story';"
                             class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105">
                    </div>

                    <!-- Text Content Div -->
                    <div class="p-5">
                        <h3 class="text-md font-bold text-white mt-1 group-hover:text-cyan-300 transition-colors">
                            ${article.title}
                        </h3>
                         <span class="text-xs font-medium text-gray-400 mt-2 block">${timeAgo}</span>
                    </div>
                </a>
            `;
      }

      /**
       * Renders the main article content to the page.
       */
      function renderArticle(article) {
        const timeAgo = article.publishedAt
          ? formatRelativeTime(article.publishedAt)
          : "Just now";

        // Set document title
        document.title = `${article.title} | The Daily Origin`;

        // Populate header
        articleCategoryLink.innerText = article.category;
        articleCategoryLink.href = `./category.html?category=${article.category}`;
        articleTitle.innerText = article.title;
        articleDate.innerText = timeAgo;

        // --- NEW: Set author byline dynamically ---
        // If we have an authorId, make the byline a link to the bio box.
        // Otherwise, just display the text.
        const articleAuthorContainer = document.getElementById(
          "author-byline-container"
        );
        if (article.authorId && article.authorName) {
          // Author EXISTS: Make it a link
          articleAuthorContainer.innerHTML = `
                    <a href="#author-bio-box" class="hover:text-cyan-400 transition-colors" title="Read more about ${article.authorName}">
                        By ${article.authorName}
                    </a>
                `;
        } else {
          // NO Author or Old Article: Just plain text
          articleAuthorContainer.innerHTML = `
                    <span>By ${
                      article.authorName || "The Daily Origin Staff"
                    }</span>
                `;
        }

        // Populate image
        articleImage.src =
          article.imageUrl ||
          "https://placehold.co/1200x700/0f172a/1e293b?text=Image+Not+Available";
        articleImage.alt = article.title;
        articleImageCaption.innerText = article.summary || article.title;

        // Populate body
        // --- NEW: Check for a real 'body' field first ---
        if (article.body) {
          articleContentBody.innerHTML = article.body;
        } else {
          // Fallback to generating demo content
          articleContentBody.innerHTML = generateArticleBody(article.summary);
        }

        // Hide loading overlay AFTER content is ready
        loadingOverlay.style.display = "none";
      }

      /**
         * Creates fake "lorem ipsum" body content based on the summary.
        function generateArticleBody(summary) {
            console.warn("No 'body' field found, generating demo content.");
            // In a real app, you'd have a 'body' field in Firestore.
            // For this demo, we'll create some rich content.
            return `
                <p class="text-2xl font-medium text-gray-200 leading-relaxed">${summary}</p>
                <p>This is a developing story. The Daily Origin is actively gathering more information and will provide updates as they become available. The situation remains fluid, and officials are urging the public to rely on verified sources.</p>
                
                <h2>The Core of the Issue</h2>
                <p>At the heart of this development lies a complex web of factors that have been culminating for months. Sources close to the matter indicate that the primary catalyst was a decision made in the early hours of Tuesday morning, a decision that has sent ripples across the industry.</p>
                <blockquote>"We are witnessing a paradigm shift, the likes of which haven't been seen since the dawn of the internet age," one analyst told The Daily Origin. "The long-term implications are simply staggering."</blockquote>
                
                <h2>What Happens Next?</h2>
                <p>All eyes are now on the upcoming emergency meeting scheduled for this Friday. The outcome of this meeting will likely set the course for the next quarter and could have ramifications that extend far beyond the immediate stakeholders. <strong>The Daily Origin</strong> will have live coverage of the event.</p>
                <p>For now, the key players remain tight-lipped, offering only prepared statements that shed little light on their next moves. The uncertainty has led to significant volatility in related markets, a trend that is expected to continue until a clearer picture emerges.</p>
            `;
        }
        
        /**
         * Renders the related articles list.
         */
      function renderRelatedArticles(articles) {
        relatedArticlesList.innerHTML = ""; // Clear loading text

        if (articles.length === 0) {
          relatedArticlesList.innerHTML =
            '<p class="text-gray-500">No related stories found.</p>';
          return;
        }

        articles.forEach((article) => {
          relatedArticlesList.innerHTML += createRelatedArticleHTML(article);
        });
      }

      /**
       * Gets article ID from URL.
       */
      function getArticleIdFromURL() {
        const params = new URLSearchParams(window.location.search);
        return params.get("id"); // e.g., "article.html?id=DOCUMENT_ID"
      }

      // NEW: Fetches and renders the author bio box
      async function loadAuthorInfo(authorId) {
        if (!authorId) {
          console.log("No authorId, skipping bio box.");
          return;
        }

        const authorsCollectionPath = `artifacts/${appId}/public/data/authors`;
        try {
          const authorDocRef = doc(db, authorsCollectionPath, authorId);
          const authorDoc = await getDoc(authorDocRef);

          if (authorDoc.exists()) {
            const author = authorDoc.data();
            authorBioName.innerText = author.name;
            authorBioText.innerText = author.bio || "No bio available.";
            if (author.imageUrl) {
              authorBioImage.src = author.imageUrl;
            }
            authorBioBox.classList.remove("hidden");
          } else {
            console.warn("Author document not found.");
          }
        } catch (error) {
          console.error("Error fetching author info:", error);
        }
      }

      /**
       * Fetches and renders related articles.
       */
      async function fetchRelatedArticles(category) {
        const articlesCollectionPath = `artifacts/${appId}/public/data/articles`;

        // Query for 4 other articles in the same category,
        // excluding the current one (though hard to do without !=)
        // So we fetch 5, and filter out the current one.
        const q = query(
          collection(db, articlesCollectionPath),
          where("category", "==", category),
          limit(5) // Fetch 5, just in case one is the current article
        );

        onSnapshot(
          q,
          (snapshot) => {
            const articles = [];
            snapshot.forEach((doc) => {
              // Filter out the article we are currently viewing
              if (doc.id !== currentArticleId) {
                articles.push({ id: doc.id, ...doc.data() });
              }
            });

            // We only want 4, so slice
            renderRelatedArticles(articles.slice(0, 4));
          },
          (error) => {
            console.error("Error fetching related articles: ", error);
            relatedArticlesList.innerHTML =
              '<p class="text-red-500">Could not load related stories.</p>';
          }
        );
      }

      // --- Main App Initialization ---
      async function initApp() {
        console.log("Initializing Article Page...");

        // Render icons
        lucide.createIcons();

        currentArticleId = getArticleIdFromURL();

        if (!currentArticleId) {
          console.error("No article ID found in URL.");
          loadingText.innerText = "Article not found. Redirecting...";
          articleError.classList.remove("hidden");
          loadingOverlay.style.display = "none";
          return;
        }

        loadingText.innerText = `Loading article...`;

        try {
          // Initialize Firebase (no auth needed for public read)
          app = initializeApp(firebaseConfig);
          db = getFirestore(app);

          // 1. Get the specific article document
          const articlesCollectionPath = `artifacts/${appId}/public/data/articles`;
          const docRef = doc(db, articlesCollectionPath, currentArticleId);
          const docSnap = await getDoc(docRef);

          if (docSnap.exists()) {
            const article = docSnap.data();
            // 2. Render the main article
            renderArticle(article);
            // 3. Fetch related articles from the same category
            await fetchRelatedArticles(article.category);
            // 4. NEW: Load author bio box
            await loadAuthorInfo(article.authorId);
          } else {
            console.error("No such document!");
            loadingText.innerText = "Article not found.";
            articleError.classList.remove("hidden");
            loadingOverlay.style.display = "none";
          }
        } catch (error) {
          console.error("Error initializing Firebase:", error);
          loadingOverlay.innerHTML =
            '<p class="text-red-500">Fatal Error: Could not initialize application.</p>';
        }
      }

      // Start the application on window load
      window.onload = initApp;
    </script>
  </body>
</html>
