<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Publisher Suite - Bilingual</title>

    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Load html2canvas library for downloading the poster -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Load Fonts (English & Bangla) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Oswald:wght@500;700&family=Caveat:wght@700&family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=Bebas+Neue&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Chakra+Petch:wght@600;700&family=Cinzel:wght@700&family=Hind+Siliguri:wght@400;500;600;700&family=Noto+Serif+Bengali:wght@400;700;900&family=Baloo+Da+2:wght@500;700;800&family=Galada&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Inter", "Hind Siliguri", sans-serif;
        background-color: #0f172a; /* slate-900 */
      }

      /* --- Typography Utilities (English Base) --- */
      .font-oswald {
        font-family: "Oswald", sans-serif;
      }
      .font-playfair {
        font-family: "Playfair Display", serif;
      }
      .font-bebas {
        font-family: "Bebas Neue", sans-serif;
      }
      .font-merriweather {
        font-family: "Merriweather", serif;
      }
      .font-chakra {
        font-family: "Chakra Petch", sans-serif;
      }
      .font-cinzel {
        font-family: "Cinzel", serif;
      }
      .font-caveat {
        font-family: "Caveat", cursive;
      }

      /* --- Bangla Overrides (Applied via Body Class) --- */
      body.lang-bangla .font-oswald,
      body.lang-bangla .poster-headline-text,
      body.lang-bangla .poster-brand-text,
      body.lang-bangla .poster-category-text,
      body.lang-bangla .poster-attribution-text {
        font-family: "Hind Siliguri", sans-serif;
      }

      body.lang-bangla .font-playfair,
      body.lang-bangla .font-merriweather,
      body.lang-bangla .font-cinzel {
        font-family: "Noto Serif Bengali", serif;
      }

      body.lang-bangla .font-bebas,
      body.lang-bangla .font-chakra {
        font-family: "Baloo Da 2", sans-serif;
      }

      body.lang-bangla .font-caveat {
        font-family: "Galada", cursive;
      }

      /* --- CSS Variables for Transforms --- */
      :root {
        --text-scale: 1;
        --text-lh: 1.4; /* Default Fallback */
        --text-spacing: 0em;
        --text-x: 0px;
        --text-y: 0px;
        --text-align: inherit;
      }

      /* --- Base Poster Font Styles (Defaults) --- */
      .poster-headline-text {
        font-family: "Oswald", sans-serif;
        font-weight: 700;
        text-transform: uppercase;

        /* Apply dynamic variables */
        font-size: calc(clamp(1.5rem, 5vw, 2.5rem) * var(--text-scale));
        line-height: var(--text-lh);
        letter-spacing: var(--text-spacing);
        transform: translate(var(--text-x), var(--text-y));
        text-align: var(--text-align);

        /* Ensure transforms don't break flow unexpectedly */
        display: block;
        transform-origin: center center;
      }

      /* Bangla specific headline adjustments */
      body.lang-bangla .poster-headline-text {
        text-transform: none;
        /* We let user override, but default is slightly looser */
        font-weight: 700;
      }

      .poster-brand-text {
        font-family: "Oswald", sans-serif;
        font-weight: 700;
        text-transform: uppercase;
        font-size: clamp(1.25rem, 4vw, 2rem);
        line-height: 1;
      }

      body.lang-bangla .poster-brand-text {
        text-transform: none;
      }

      .poster-attribution-text {
        font-family: "Inter", sans-serif;
        font-style: italic;
        font-size: clamp(0.875rem, 2.5vw, 1.25rem);
        line-height: 1.4;
      }

      body.lang-bangla .poster-attribution-text {
        font-style: normal;
      }

      .poster-category-text {
        font-family: "Inter", sans-serif;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.1em;
      }

      /* --- Selector Styles --- */
      .template-selector {
        border: 2px solid #374151; /* gray-700 */
        transition: all 0.2s ease-in-out;
        cursor: pointer;
      }
      .template-selector:hover {
        border-color: #6b7280; /* gray-500 */
      }
      .template-selector.selected {
        border-color: #3b82f6; /* blue-500 */
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
      }

      /* --- TEMPLATE OVERRIDES WITH VARIABLES --- */

      /* TEMPLATE 5: Editorial */
      #template-editorial .poster-headline-text {
        font-family: "Playfair Display", serif;
        font-weight: 900;
        text-transform: none;
        font-size: calc(clamp(2rem, 7vw, 4rem) * var(--text-scale));
        line-height: var(--text-lh, 1.1); /* Default 1.1 if not overridden */
      }
      body.lang-bangla #template-editorial .poster-headline-text {
        font-family: "Noto Serif Bengali", serif;
      }

      /* TEMPLATE 6: Football */
      #template-football .poster-headline-text {
        font-family: "Bebas Neue", sans-serif;
        font-weight: 400;
        text-transform: uppercase;
        font-size: calc(clamp(3rem, 10vw, 6.5rem) * var(--text-scale));
        line-height: var(--text-lh, 0.9);
        text-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
      }
      body.lang-bangla #template-football .poster-headline-text {
        font-family: "Baloo Da 2", sans-serif;
        font-weight: 800;
        text-transform: none;
      }

      /* TEMPLATE 7: Broadcast */
      #template-broadcast .poster-headline-text {
        font-family: "Chakra Petch", sans-serif;
        font-weight: 700;
        text-transform: uppercase;
        font-size: calc(clamp(1.8rem, 5vw, 3.5rem) * var(--text-scale));
        line-height: var(--text-lh, 1.1);
        background-color: rgba(0, 0, 0, 0.7);
        padding: 0.2em 0;
        box-decoration-break: clone;
        -webkit-box-decoration-break: clone;
        display: inline; /* Special case for box decoration */
      }
      body.lang-bangla #template-broadcast .poster-headline-text {
        font-family: "Hind Siliguri", sans-serif;
        font-weight: 700;
      }

      /* TEMPLATE 8: Paper */
      #template-paper {
        background-color: #f8f5f2;
        color: #1a1a1a;
      }
      #template-paper .poster-headline-text {
        font-family: "Merriweather", serif;
        font-weight: 900;
        font-style: italic;
        text-transform: none;
        font-size: calc(clamp(1.5rem, 4.5vw, 3rem) * var(--text-scale));
        line-height: var(--text-lh, 1.2);
        color: #000;
      }
      body.lang-bangla #template-paper .poster-headline-text {
        font-family: "Noto Serif Bengali", serif;
        font-style: normal;
      }
      #template-paper .poster-category-text {
        font-family: "Cinzel", serif;
        font-weight: 700;
        border-bottom: 2px solid #000;
        padding-bottom: 4px;
        margin-bottom: 12px;
        display: inline-block;
      }
      body.lang-bangla #template-paper .poster-category-text {
        font-family: "Noto Serif Bengali", serif;
      }

      /* TEMPLATE 9: Swiss */
      #template-swiss .poster-headline-text {
        font-family: "Inter", sans-serif;
        font-weight: 800;
        text-transform: none;
        letter-spacing: var(--text-spacing, -0.04em);
        font-size: calc(clamp(2.5rem, 8vw, 5rem) * var(--text-scale));
        line-height: var(--text-lh, 0.95);
      }
      body.lang-bangla #template-swiss .poster-headline-text {
        font-family: "Hind Siliguri", sans-serif;
        font-weight: 700;
        letter-spacing: var(--text-spacing, normal);
      }

      /* Toggle Switch Styles */
      .toggle-checkbox:checked {
        right: 0;
        border-color: #68d391;
      }
      .toggle-checkbox:checked + .toggle-label {
        background-color: #68d391;
      }
    </style>
  </head>
  <body class="text-gray-300">
    <div class="container mx-auto p-4 lg:p-8">
      <!-- Header -->
      <div
        class="flex flex-col md:flex-row justify-between items-center mb-8 border-b border-gray-800 pb-6"
      >
        <div>
          <h1 class="text-3xl font-bold text-white tracking-tight">
            The Publisher <span class="text-blue-500">Suite</span>
          </h1>
          <p class="text-sm text-gray-500 mt-1">
            Global Newsroom Edition
          </p>
        </div>

        <div class="flex items-center gap-4 mt-4 md:mt-0">
          <!-- Language Toggle -->
          <div
            class="flex items-center bg-gray-800 rounded-full p-1 border border-gray-700"
          >
            <button
              id="lang-en"
              class="px-4 py-1.5 rounded-full text-xs font-bold transition-colors bg-blue-600 text-white"
            >
              ENG
            </button>
            <button
              id="lang-bn"
              class="px-4 py-1.5 rounded-full text-xs font-bold transition-colors text-gray-400 hover:text-white"
            >
              বাংলা
            </button>
          </div>

          <div
            class="px-3 py-1 bg-gray-800 rounded-full text-xs font-mono text-blue-400 border border-blue-500/30"
          >
            v2.2 • Layout Controls
          </div>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
        <!-- --- CONTROLS PANEL --- -->
        <div
          class="lg:col-span-4 bg-gray-800/50 p-6 rounded-xl border border-gray-700 backdrop-blur-sm lg:sticky lg:top-8 lg:max-h-[calc(100vh-4rem)] lg:overflow-y-auto custom-scrollbar"
        >
          <!-- Template Selection -->
          <div class="mb-8">
            <label
              class="block text-xs font-semibold text-blue-400 uppercase tracking-wider mb-3"
              >Select Layout</label
            >
            <div class="grid grid-cols-3 gap-3">
              <!-- Original 1: Headline -->
              <div
                id="select-headline"
                class="template-selector selected rounded bg-gray-900 p-2 aspect-square flex flex-col justify-between"
                data-template="headline"
              >
                <div class="w-full h-1 bg-gray-700"></div>
                <div
                  class="w-3/4 h-16 bg-gray-800 rounded mx-auto border border-gray-700"
                ></div>
                <div class="text-[9px] text-center font-bold text-gray-500">
                  CLASSIC
                </div>
              </div>

              <!-- Original 2: Overlay -->
              <div
                id="select-overlay"
                class="template-selector rounded bg-gray-900 aspect-square relative overflow-hidden"
                data-template="overlay"
              >
                <div class="absolute inset-0 bg-gray-800"></div>
                <div
                  class="absolute bottom-0 w-full h-1/2 bg-black/60 flex items-end p-2"
                >
                  <div class="w-full h-1 bg-white/50 mb-1"></div>
                </div>
                <div
                  class="absolute top-2 left-2 text-[9px] font-bold text-white z-10"
                >
                  OVERLAY
                </div>
              </div>

              <!-- Original 3: Editorial -->
              <div
                id="select-editorial"
                class="template-selector rounded bg-gray-900 p-2 aspect-square flex flex-col items-center justify-center relative overflow-hidden"
                data-template="editorial"
              >
                <div class="text-[20px] font-serif font-bold text-gray-600">
                  Ed.
                </div>
                <div class="text-[9px] font-bold text-gray-500 mt-1">
                  EDITORIAL
                </div>
              </div>

              <!-- Original 4: Football -->
              <div
                id="select-football"
                class="template-selector rounded bg-gray-900 aspect-square flex flex-col items-center justify-center relative overflow-hidden"
                data-template="football"
              >
                <div
                  class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-black opacity-50"
                ></div>
                <div class="relative z-10 font-bebas text-xl text-yellow-500">
                  SPORT
                </div>
              </div>

              <!-- NEW 5: The Broadcast -->
              <div
                id="select-broadcast"
                class="template-selector rounded bg-gray-900 aspect-square flex flex-col justify-end relative overflow-hidden group"
                data-template="broadcast"
              >
                <div
                  class="absolute top-2 left-2 bg-red-600 w-2 h-2 rounded-full animate-pulse"
                ></div>
                <div class="bg-red-600 h-2 w-1/3 mb-1 ml-1"></div>
                <div class="bg-white h-4 w-full opacity-10"></div>
                <div
                  class="absolute top-2 right-2 text-[9px] font-bold text-white"
                >
                  NEWS
                </div>
              </div>

              <!-- NEW 6: The Paper -->
              <div
                id="select-paper"
                class="template-selector rounded bg-[#f8f5f2] aspect-square flex flex-col p-2 items-center text-center justify-center"
                data-template="paper"
              >
                <div class="w-full h-px bg-black mb-1"></div>
                <div
                  class="font-serif text-black text-xs font-bold leading-tight"
                >
                  The<br />Times
                </div>
                <div class="w-full h-px bg-black mt-1"></div>
              </div>

              <!-- NEW 7: Swiss -->
              <div
                id="select-swiss"
                class="template-selector rounded bg-blue-600 aspect-square flex flex-col p-2 justify-between"
                data-template="swiss"
              >
                <div
                  class="text-white font-bold text-2xl leading-none tracking-tighter"
                >
                  Aa
                </div>
                <div class="text-[9px] font-bold text-white self-end">
                  SWISS
                </div>
              </div>

              <!-- Original Card (Moved to end) -->
              <div
                id="select-card"
                class="template-selector rounded bg-gray-900 p-2 aspect-square flex flex-row items-center"
                data-template="card"
              >
                <div class="w-1/3 h-full border-r border-gray-700"></div>
                <div class="w-2/3 h-full bg-gray-800"></div>
              </div>

              <!-- Original Quote (Moved to end) -->
              <div
                id="select-quote"
                class="template-selector rounded bg-gray-900 aspect-square flex items-center justify-center"
                data-template="quote"
              >
                <span class="font-serif text-2xl text-gray-600">“</span>
              </div>
            </div>
          </div>

          <!-- Input Fields -->
          <div class="space-y-5">
            <!-- Category Tag (NEW) -->
            <div>
              <label class="block text-xs font-medium text-gray-400 mb-1"
                >Category / Tag</label
              >
              <input
                type="text"
                id="category-input"
                class="w-full p-2 bg-gray-900 border border-gray-700 rounded text-white text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-colors"
                placeholder="e.g. BREAKING NEWS"
              />
            </div>

            <!-- Headline -->
            <div>
              <label class="block text-xs font-medium text-gray-400 mb-1"
                >Headline</label
              >
              <textarea
                id="headline-input"
                rows="3"
                class="w-full p-2 bg-gray-900 border border-gray-700 rounded text-white text-base focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition-colors font-medium"
                placeholder="Enter your main headline..."
              ></textarea>

              <!-- Mini Toolbar -->
              <div class="flex gap-2 mt-2">
                <div class="relative flex-1">
                  <input
                    type="color"
                    id="highlight-color-input"
                    value="#FFFF00"
                    class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                  />
                  <button
                    class="w-full bg-gray-700 hover:bg-gray-600 text-[10px] py-1 rounded text-gray-300"
                  >
                    Highlight Color
                  </button>
                </div>
                <div class="relative flex-1">
                  <input
                    type="color"
                    id="text-color-input"
                    value="#FFFFFF"
                    class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                  />
                  <button
                    class="w-full bg-gray-700 hover:bg-gray-600 text-[10px] py-1 rounded text-gray-300"
                  >
                    Text Color
                  </button>
                </div>
              </div>
            </div>

            <!-- NEW: Typography & Layout Controls -->
            <div
              class="bg-gray-900/50 rounded border border-gray-700/50 p-3 space-y-4"
            >
              <div
                class="flex items-center justify-between border-b border-gray-700 pb-2"
              >
                <span class="text-xs font-bold text-blue-400 uppercase"
                  >Typography & Layout</span
                >
                <button
                  id="reset-typography-btn"
                  class="text-[9px] text-gray-500 hover:text-white uppercase"
                >
                  Reset
                </button>
              </div>

              <!-- Font Size & Line Height -->
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label class="text-[9px] text-gray-500 uppercase block mb-1"
                    >Font Size</label
                  >
                  <input
                    type="range"
                    id="text-scale-input"
                    min="0.5"
                    max="2.0"
                    step="0.05"
                    value="1"
                    class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"
                  />
                </div>
                <div>
                  <label class="text-[9px] text-gray-500 uppercase block mb-1"
                    >Line Height</label
                  >
                  <input
                    type="range"
                    id="text-lh-input"
                    min="0.8"
                    max="2.0"
                    step="0.05"
                    value="1.2"
                    class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"
                  />
                </div>
              </div>

              <!-- Spacing & Alignment -->
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label class="text-[9px] text-gray-500 uppercase block mb-1"
                    >Letter Spacing</label
                  >
                  <input
                    type="range"
                    id="text-spacing-input"
                    min="-0.1"
                    max="0.5"
                    step="0.01"
                    value="0"
                    class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"
                  />
                </div>
                <div>
                  <label class="text-[9px] text-gray-500 uppercase block mb-1"
                    >Alignment</label
                  >
                  <div class="flex bg-gray-800 rounded">
                    <button
                      class="flex-1 py-1 text-gray-400 hover:text-white hover:bg-gray-700 rounded text-xs"
                      data-align="left"
                      onclick="setTextAlign('left')"
                    >
                      L
                    </button>
                    <button
                      class="flex-1 py-1 text-gray-400 hover:text-white hover:bg-gray-700 rounded text-xs"
                      data-align="center"
                      onclick="setTextAlign('center')"
                    >
                      C
                    </button>
                    <button
                      class="flex-1 py-1 text-gray-400 hover:text-white hover:bg-gray-700 rounded text-xs"
                      data-align="right"
                      onclick="setTextAlign('right')"
                    >
                      R
                    </button>
                  </div>
                </div>
              </div>

              <!-- Text Position -->
              <div>
                <div class="flex justify-between mb-1">
                  <label class="text-[9px] text-gray-500 uppercase"
                    >Move Text (X / Y)</label
                  >
                  <span class="text-[9px] text-gray-600">OFFSET</span>
                </div>
                <div class="grid grid-cols-2 gap-2">
                  <input
                    type="range"
                    id="text-x-input"
                    min="-100"
                    max="100"
                    step="1"
                    value="0"
                    class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"
                    title="Horizontal Move"
                  />
                  <input
                    type="range"
                    id="text-y-input"
                    min="-100"
                    max="100"
                    step="1"
                    value="0"
                    class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"
                    title="Vertical Move"
                  />
                </div>
              </div>
            </div>

            <!-- Attribution -->
            <div>
              <label class="block text-xs font-medium text-gray-400 mb-1"
                >Attribution / Sub-head</label
              >
              <input
                type="text"
                id="attribution-input"
                class="w-full p-2 bg-gray-900 border border-gray-700 rounded text-white text-sm focus:border-blue-500 outline-none"
                placeholder="Author Name or Sub-headline"
              />
            </div>

            <!-- Brand -->
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-xs font-medium text-gray-400 mb-1"
                  >Brand Name</label
                >
                <input
                  type="text"
                  id="brand-input"
                  class="w-full p-2 bg-gray-900 border border-gray-700 rounded text-white text-sm outline-none"
                  placeholder="Default"
                />
              </div>
              <div>
                <label class="block text-xs font-medium text-gray-400 mb-1"
                  >Accent Color</label
                >
                <div class="flex items-center space-x-2">
                  <input
                    type="color"
                    id="accent-color-input"
                    value="#3b82f6"
                    class="h-9 w-12 bg-gray-900 border border-gray-700 rounded cursor-pointer p-0.5"
                  />
                  <input
                    type="color"
                    id="bg-color-input"
                    value="#111827"
                    class="h-9 w-12 bg-gray-900 border border-gray-700 rounded cursor-pointer p-0.5"
                    title="Background Color"
                  />
                </div>
              </div>
            </div>

            <!-- Effect Controls (Collapsible-ish feel) -->
            <div
              class="bg-gray-900/50 rounded border border-gray-700/50 p-3 space-y-3"
            >
              <div class="flex items-center justify-between">
                <span class="text-xs font-bold text-gray-400 uppercase"
                  >Text Automation</span
                >
              </div>
              <div>
                <label class="text-[10px] text-gray-500 uppercase"
                  >Highlight Words</label
                >
                <input
                  type="text"
                  id="highlight-words-input"
                  class="w-full bg-gray-800 border-none rounded h-7 text-xs px-2 text-gray-300 placeholder-gray-600"
                  placeholder="word1, word2"
                />
              </div>
              <div>
                <label class="text-[10px] text-gray-500 uppercase"
                  >Underline Words</label
                >
                <input
                  type="text"
                  id="underline-words-input"
                  class="w-full bg-gray-800 border-none rounded h-7 text-xs px-2 text-gray-300 placeholder-gray-600"
                  placeholder="word1, word2"
                />
              </div>
            </div>

            <!-- Image Upload -->
            <div class="pt-2 border-t border-gray-700">
              <label
                class="flex items-center justify-center w-full h-24 border-2 border-gray-700 border-dashed rounded-lg cursor-pointer bg-gray-800/30 hover:bg-gray-800 transition-colors group"
              >
                <div
                  class="flex flex-col items-center justify-center pt-5 pb-6"
                >
                  <svg
                    class="w-6 h-6 mb-2 text-gray-500 group-hover:text-white"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                    ></path>
                  </svg>
                  <p class="text-xs text-gray-400 group-hover:text-gray-300">
                    Click to upload image
                  </p>
                </div>
                <input
                  type="file"
                  id="image-upload"
                  class="hidden"
                  accept="image/*"
                />
              </label>

              <!-- Image Controls -->
              <div
                id="image-adjust-controls"
                class="hidden mt-3 grid grid-cols-3 gap-2 bg-gray-900/50 p-2 rounded border border-gray-700"
              >
                <div
                  class="col-span-3 text-[10px] text-blue-400 font-bold uppercase mb-1"
                >
                  Image Controls
                </div>
                <div>
                  <label
                    class="text-[9px] text-gray-500 uppercase block text-center"
                    >Zoom</label
                  >
                  <input
                    type="range"
                    id="image-zoom-input"
                    min="1"
                    max="3"
                    step="0.1"
                    value="1"
                    class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"
                  />
                </div>
                <div>
                  <label
                    class="text-[9px] text-gray-500 uppercase block text-center"
                    >Pan X</label
                  >
                  <input
                    type="range"
                    id="image-pos-x-input"
                    min="-100"
                    max="100"
                    step="1"
                    value="0"
                    class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"
                  />
                </div>
                <div>
                  <label
                    class="text-[9px] text-gray-500 uppercase block text-center"
                    >Pan Y</label
                  >
                  <input
                    type="range"
                    id="image-pos-y-input"
                    min="-100"
                    max="100"
                    step="1"
                    value="0"
                    class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer"
                  />
                </div>
              </div>
            </div>

            <!-- Actions -->
            <div class="flex space-x-3 pt-4">
              <button
                id="reset-btn"
                class="flex-1 px-4 py-3 bg-gray-700 text-gray-300 text-sm font-bold rounded hover:bg-gray-600 transition-colors"
              >
                Reset
              </button>
              <button
                id="download-btn"
                class="flex-[2] px-4 py-3 bg-blue-600 text-white text-sm font-bold rounded hover:bg-blue-500 transition-colors shadow-lg shadow-blue-900/50 flex justify-center items-center gap-2"
              >
                <span>Download PNG</span>
                <svg
                  class="w-4 h-4"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"
                  ></path>
                </svg>
              </button>
            </div>
            <p
              id="loading-message"
              class="text-center text-xs text-blue-400 hidden animate-pulse"
            >
              Rendering high-res output...
            </p>
          </div>
        </div>

        <!-- --- PREVIEW AREA --- -->
        <div
          class="lg:col-span-8 flex items-start justify-center bg-gray-900/50 rounded-xl border border-gray-800 p-4 lg:p-12 min-h-[600px]"
        >
          <!-- The Stage (Square) -->
          <div
            id="poster-container"
            class="relative w-full max-w-[600px] aspect-square shadow-2xl overflow-hidden bg-gray-900 ring-1 ring-gray-800"
          >
            <!-- TEMPLATE 1: Classic Headline -->
            <div
              id="template-headline"
              class="w-full h-full bg-gray-900 text-white p-8 flex flex-col"
            >
              <div class="flex justify-between items-start mb-6">
                <div
                  class="poster-category-text text-xs text-blue-500 tracking-widest hidden"
                >
                  CATEGORY
                </div>
                <div class="w-full h-px bg-gray-800 my-auto"></div>
              </div>

              <h1 class="poster-headline-text text-white mb-6 flex-shrink-0">
                TYPE YOUR HEADLINE
              </h1>

              <!-- Frame for Image -->
              <div
                id="template-headline-frame"
                class="w-full flex-grow min-h-0 mb-6 p-1 border border-gray-600"
              >
                <div class="w-full h-full bg-gray-800 overflow-hidden relative">
                  <canvas
                    class="poster-image-canvas w-full h-full object-cover"
                  ></canvas>
                </div>
              </div>

              <div class="flex justify-between items-end">
                <p
                  class="poster-attribution-text text-gray-400 text-sm max-w-[60%] hidden"
                ></p>

                <!-- Brand -->
                <div class="poster-brand-container text-right">
                  <div class="poster-brand-logo flex items-end space-x-1">
                    <span class="text-xl font-oswald text-gray-200"
                      >The Daily</span
                    >
                    <span class="text-2xl font-bold text-blue-500 font-oswald"
                      >Origin</span
                    >
                  </div>
                  <span class="poster-brand-text text-gray-300 hidden"
                    >BRAND</span
                  >
                </div>
              </div>
            </div>

            <!-- TEMPLATE 2: Overlay -->
            <div
              id="template-overlay"
              class="w-full h-full bg-gray-900 text-white hidden relative group"
            >
              <canvas
                class="poster-image-canvas absolute inset-0 w-full h-full"
              ></canvas>
              <div
                class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-90"
              ></div>

              <div
                class="absolute inset-x-0 bottom-0 p-10 flex flex-col justify-end h-full"
              >
                <div class="mb-auto pt-4">
                  <span
                    class="poster-category-text px-3 py-1 bg-blue-600 text-white text-xs font-bold hidden"
                    >CATEGORY</span
                  >
                </div>

                <h1 class="poster-headline-text text-white mb-4 drop-shadow-lg">
                  TYPE YOUR HEADLINE
                </h1>

                <div class="w-16 h-1 bg-blue-500 mb-4"></div>

                <div class="flex justify-between items-center">
                  <p class="poster-attribution-text text-gray-300 hidden"></p>

                  <div class="poster-brand-container">
                    <div class="poster-brand-logo">
                      <span
                        class="text-xl font-bold font-oswald tracking-widest text-white border-2 border-white px-2 py-0.5"
                        >THE DAILY ORIGIN</span
                      >
                    </div>
                    <span class="poster-brand-text text-white hidden"
                      >BRAND</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <!-- TEMPLATE 3: Card Split -->
            <div
              id="template-card"
              class="w-full h-full bg-gray-900 hidden flex-row"
            >
              <div
                class="w-[40%] h-full p-8 flex flex-col justify-between border-r border-gray-800 z-10 bg-inherit"
              >
                <div>
                  <div
                    class="poster-category-text text-[10px] text-gray-500 mb-4 hidden"
                  >
                    CATEGORY
                  </div>
                  <h1
                    class="poster-headline-text text-inherit text-2xl lg:text-3xl"
                  >
                    HEADLINE GOES HERE
                  </h1>
                  <div
                    class="w-8 h-8 mt-6 rounded-full border border-gray-600 flex items-center justify-center"
                  >
                    <svg
                      class="w-3 h-3 text-gray-400"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M14 5l7 7m0 0l-7 7m7-7H3"
                      ></path>
                    </svg>
                  </div>
                </div>

                <div class="poster-brand-container">
                  <div class="poster-brand-logo flex flex-col">
                    <span
                      class="text-xs font-oswald text-gray-500 uppercase tracking-widest"
                      >Published By</span
                    >
                    <span class="text-xl font-bold text-blue-500 font-oswald"
                      >The Daily Origin</span
                    >
                  </div>
                  <span class="poster-brand-text text-inherit hidden"
                    >BRAND</span
                  >
                </div>
              </div>
              <div class="w-[60%] h-full relative overflow-hidden">
                <canvas
                  class="poster-image-canvas w-full h-full object-cover"
                ></canvas>
                <div
                  class="absolute bottom-6 left-6 bg-black/70 backdrop-blur-md px-4 py-2 rounded hidden attribution-container"
                >
                  <p
                    class="poster-attribution-text text-white text-xs font-medium"
                  ></p>
                </div>
              </div>
            </div>

            <!-- TEMPLATE 4: Quote -->
            <div
              id="template-quote"
              class="w-full h-full bg-gray-900 hidden relative text-center flex flex-col justify-center items-center p-12"
            >
              <canvas
                class="poster-image-canvas absolute inset-0 w-full h-full opacity-30"
              ></canvas>
              <div
                class="absolute inset-0 bg-gray-900/60 backdrop-blur-[2px]"
              ></div>

              <div class="relative z-10 max-w-md">
                <div class="text-6xl text-blue-500 font-serif mb-4 opacity-80">
                  “
                </div>
                <h1
                  class="poster-headline-text text-white italic font-light tracking-wide leading-relaxed"
                >
                  Your quote text will appear here.
                </h1>
                <div class="w-24 h-px bg-gray-500 mx-auto my-8"></div>
                <p
                  class="poster-attribution-text text-blue-400 font-bold tracking-widest uppercase text-sm hidden"
                ></p>
              </div>

              <div class="absolute bottom-8 poster-brand-container">
                <div class="poster-brand-logo">
                  <span
                    class="text-xs font-oswald text-gray-500 tracking-[0.3em]"
                    >THE DAILY ORIGIN</span
                  >
                </div>
                <span
                  class="poster-brand-text text-gray-500 text-xs tracking-widest hidden"
                  >BRAND</span
                >
              </div>
            </div>

            <!-- TEMPLATE 5: Editorial -->
            <div
              id="template-editorial"
              class="w-full h-full bg-gray-900 hidden relative"
            >
              <canvas
                class="poster-image-canvas absolute inset-0 w-full h-full"
              ></canvas>
              <div class="absolute inset-0 bg-black/40"></div>

              <!-- Border Frame -->
              <div
                class="absolute inset-4 border border-white/30 z-20 pointer-events-none"
              ></div>

              <div
                class="relative z-10 h-full flex flex-col items-center justify-center p-12 text-center"
              >
                <div
                  class="poster-category-text text-xs font-serif italic text-white/80 mb-4 tracking-widest border-b border-white/30 pb-1 px-4 hidden"
                >
                  Category
                </div>

                <h1 class="poster-headline-text text-white mb-6 drop-shadow-xl">
                  Editorial Headline
                </h1>

                <p
                  class="poster-attribution-text text-white/90 font-serif text-lg hidden"
                ></p>

                <div class="absolute bottom-10 poster-brand-container">
                  <div
                    class="poster-brand-logo font-playfair font-bold text-2xl text-white"
                  >
                    The Daily Origin.
                  </div>
                  <span
                    class="poster-brand-text text-white font-playfair font-bold hidden"
                    >BRAND</span
                  >
                </div>
              </div>
            </div>

            <!-- TEMPLATE 6: Football -->
            <div
              id="template-football"
              class="w-full h-full bg-black hidden relative overflow-hidden"
            >
              <!-- Background Graphic -->
              <canvas
                class="poster-image-canvas absolute inset-0 w-full h-full object-cover opacity-80"
                style="mix-blend-mode: luminosity;"
              ></canvas>

              <!-- Gold Overlay/Vignette -->
              <div
                class="absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent"
              ></div>
              <div
                class="absolute inset-0 bg-gradient-to-r from-black/80 via-transparent to-black/80"
              ></div>

              <div class="relative z-10 h-full flex flex-col p-8">
                <!-- Top Bar -->
                <div
                  class="flex justify-between items-center border-b border-white/20 pb-4 mb-auto"
                >
                  <div class="flex items-center gap-2">
                    <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                    <span
                      class="text-xs font-bold text-white tracking-widest uppercase"
                      >Match Day</span
                    >
                  </div>
                  <span
                    class="poster-category-text text-yellow-500 font-bebas text-xl hidden"
                    >LEAGUE</span
                  >
                </div>

                <!-- Main Content -->
                <div class="text-center py-8">
                  <h1
                    class="poster-headline-text text-white italic transform -skew-x-6"
                  >
                    MATCH RESULT
                  </h1>
                  <div
                    class="w-full h-1 bg-gradient-to-r from-transparent via-yellow-500 to-transparent mt-2"
                  ></div>
                </div>

                <!-- Bottom Stats/Attribution -->
                <div class="mt-auto flex flex-col items-center">
                  <p
                    class="poster-attribution-text text-gray-300 font-oswald text-xl uppercase tracking-widest mb-6 hidden"
                  ></p>

                  <div class="poster-brand-container">
                    <div
                      class="poster-brand-logo bg-white text-black px-4 py-1 font-bebas text-2xl transform -skew-x-12"
                    >
                      THE DAILY ORIGIN
                    </div>
                    <span
                      class="poster-brand-text text-white font-bebas text-2xl hidden"
                      >BRAND</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <!-- NEW TEMPLATE 7: The Broadcast (CNN Style) -->
            <div
              id="template-broadcast"
              class="w-full h-full bg-gray-900 hidden relative overflow-hidden"
            >
              <canvas
                class="poster-image-canvas absolute inset-0 w-full h-full object-cover"
              ></canvas>

              <!-- "Live" Badge -->
              <div
                class="absolute top-8 left-8 bg-white/90 px-3 py-1 flex items-center gap-2 z-20 shadow-lg"
              >
                <div
                  class="w-3 h-3 bg-red-600 rounded-full animate-pulse"
                ></div>
                <span
                  class="text-red-700 font-bold text-sm uppercase font-oswald tracking-wide"
                  >LIVE</span
                >
              </div>
              <div
                class="poster-category-text absolute top-8 right-8 bg-red-600 text-white px-3 py-1 text-sm font-bold uppercase shadow-lg hidden"
              >
                BREAKING
              </div>

              <!-- Lower Third Complex -->
              <div class="absolute bottom-0 left-0 right-0 z-20">
                <!-- Headline Bar -->
                <div
                  class="bg-red-700/90 backdrop-blur-sm px-8 py-2 w-fit min-w-[30%] skew-x-12 -ml-4 border-r-4 border-white"
                >
                  <span
                    class="text-white font-bold uppercase text-xs tracking-widest -skew-x-12 block ml-4"
                    >Breaking News</span
                  >
                </div>

                <div
                  class="bg-white/95 text-black p-6 pl-8 border-l-8 border-red-600 shadow-2xl relative"
                >
                  <h1 class="poster-headline-text text-black mb-2">
                    HEADLINE TEXT
                  </h1>
                  <div class="flex items-center gap-3 mt-2">
                    <span
                      class="bg-black text-white px-2 py-0.5 text-xs font-bold uppercase"
                      >UPDATED</span
                    >
                    <p
                      class="poster-attribution-text text-gray-800 font-bold text-sm uppercase hidden"
                    ></p>
                  </div>

                  <!-- Brand Watermark -->
                  <div class="absolute right-4 bottom-4 opacity-20">
                    <div class="poster-brand-container">
                      <div
                        class="poster-brand-logo text-4xl font-black font-oswald tracking-tighter"
                      >
                        THE DAILY ORIGIN
                      </div>
                      <span
                        class="poster-brand-text text-4xl font-black font-oswald hidden"
                        >BRAND</span
                      >
                    </div>
                  </div>
                </div>

                <!-- Ticker Tape -->
                <div
                  class="bg-black text-white py-2 px-8 flex items-center gap-4 overflow-hidden"
                >
                  <span
                    class="text-yellow-400 font-bold text-xs uppercase whitespace-nowrap"
                    >DEVELOPING STORY</span
                  >
                  <span class="text-gray-500">///</span>
                  <span class="text-xs font-mono uppercase truncate w-full"
                    >Latest updates coming in from the newsroom...</span
                  >
                </div>
              </div>
            </div>

            <!-- NEW TEMPLATE 8: The Paper (NYT Style) -->
            <div
              id="template-paper"
              class="w-full h-full hidden flex-col p-8 md:p-12 relative border border-gray-200 shadow-inner"
            >
              <!-- Header Date Line -->
              <div
                class="border-b-2 border-black pb-1 mb-1 flex justify-between items-end"
              >
                <div
                  class="text-[10px] font-bold uppercase font-sans text-gray-500"
                >
                  Vol. 124, No. 42
                </div>
                <div class="poster-brand-container">
                  <div
                    class="poster-brand-logo font-cinzel font-black text-3xl tracking-tight"
                  >
                    The Daily Origin
                  </div>
                  <span
                    class="poster-brand-text font-cinzel font-black text-2xl hidden"
                    >BRAND</span
                  >
                </div>
                <div
                  class="text-[10px] font-bold uppercase font-sans text-gray-500"
                >
                  Late Edition
                </div>
              </div>
              <div class="border-b border-black mb-8"></div>

              <!-- Content Grid -->
              <div class="flex-grow flex flex-col items-center text-center">
                <div
                  class="poster-category-text text-xs tracking-widest mb-4 font-sans font-bold text-gray-800 hidden"
                >
                  CATEGORY
                </div>

                <h1 class="poster-headline-text text-black mb-6 max-w-[90%]">
                  Headline Text Goes Here
                </h1>

                <!-- Image Area -->
                <div
                  class="w-full flex-grow relative mb-4 border border-gray-300 p-1"
                >
                  <canvas
                    class="poster-image-canvas w-full h-full object-cover filter grayscale contrast-125"
                  ></canvas>
                  <div
                    class="absolute bottom-2 right-2 bg-white px-2 py-1 text-[8px] font-sans text-gray-500 border border-gray-200"
                  >
                    Photo: Staff
                  </div>
                </div>

                <!-- Caption / Attribution -->
                <div class="w-full text-left flex gap-4 mt-2">
                  <p
                    class="poster-attribution-text text-gray-600 font-serif text-sm italic w-2/3 hidden"
                  >
                    By Author Name
                  </p>
                  <!-- Fake Article Text lines -->
                  <div class="w-full space-y-1 opacity-40">
                    <div class="h-1 bg-gray-400 w-full"></div>
                    <div class="h-1 bg-gray-400 w-[95%]"></div>
                    <div class="h-1 bg-gray-400 w-[90%]"></div>
                  </div>
                </div>
              </div>
            </div>

            <!-- NEW TEMPLATE 9: The Swiss (Modern/Design) -->
            <div
              id="template-swiss"
              class="w-full h-full bg-blue-600 text-white hidden relative p-8 flex flex-col justify-between"
            >
              <!-- Background Geometric -->
              <div class="absolute inset-0 z-0 overflow-hidden">
                <div
                  class="absolute -top-[20%] -right-[20%] w-[80%] h-[80%] rounded-full bg-white/10 blur-3xl"
                ></div>
                <div
                  class="absolute -bottom-[10%] -left-[10%] w-[60%] h-[60%] rounded-full bg-black/10 blur-2xl"
                ></div>
              </div>

              <!-- Top Bar -->
              <div
                class="relative z-10 flex justify-between items-start border-t-4 border-white pt-4"
              >
                <div class="poster-brand-container">
                  <div
                    class="poster-brand-logo font-inter font-black text-2xl tracking-tighter"
                  >
                    Aa.
                  </div>
                  <span
                    class="poster-brand-text font-inter font-black text-xl hidden"
                    >BRAND</span
                  >
                </div>
                <span
                  class="poster-category-text font-mono text-xs bg-white text-blue-600 px-2 py-1 hidden"
                  >CATEGORY</span
                >
              </div>

              <!-- Middle Content -->
              <div class="relative z-10 my-auto">
                <h1 class="poster-headline-text text-white mb-8">
                  Swiss Design Headline
                </h1>

                <div class="flex items-center gap-6">
                  <!-- Small circular image -->
                  <div
                    class="w-24 h-24 rounded-full overflow-hidden ring-4 ring-white/20 flex-shrink-0"
                  >
                    <canvas
                      class="poster-image-canvas w-full h-full object-cover"
                    ></canvas>
                  </div>
                  <div class="h-px bg-white/40 flex-grow"></div>
                </div>
              </div>

              <!-- Bottom -->
              <div
                class="relative z-10 grid grid-cols-2 gap-4 text-xs font-mono opacity-80"
              >
                <div>
                  <p class="mb-1 uppercase">Author</p>
                  <p class="poster-attribution-text font-bold hidden">-</p>
                </div>
                <div class="text-right">
                  <p class="mb-1 uppercase">Date</p>
                  <p class="font-bold">2026</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Script Logic -->
    <script>
      // --- Element References ---
      const headlineInput = document.getElementById("headline-input");
      const categoryInput = document.getElementById("category-input");
      const attributionInput = document.getElementById("attribution-input");
      const brandInput = document.getElementById("brand-input");
      const imageUpload = document.getElementById("image-upload");
      const posterContainer = document.getElementById("poster-container");

      const bgColorInput = document.getElementById("bg-color-input");
      const textColorInput = document.getElementById("text-color-input");
      const accentColorInput = document.getElementById("accent-color-input");

      const highlightWordsInput = document.getElementById(
        "highlight-words-input"
      );
      const highlightColorInput = document.getElementById(
        "highlight-color-input"
      );
      const underlineWordsInput = document.getElementById(
        "underline-words-input"
      );

      // Typography Inputs
      const textScaleInput = document.getElementById("text-scale-input");
      const textLhInput = document.getElementById("text-lh-input");
      const textSpacingInput = document.getElementById("text-spacing-input");
      const textXInput = document.getElementById("text-x-input");
      const textYInput = document.getElementById("text-y-input");
      const resetTypeBtn = document.getElementById("reset-typography-btn");

      const imageAdjustControls = document.getElementById(
        "image-adjust-controls"
      );
      const imageZoomInput = document.getElementById("image-zoom-input");
      const imagePosXInput = document.getElementById("image-pos-x-input");
      const imagePosYInput = document.getElementById("image-pos-y-input");

      // Lang Toggles
      const langEnBtn = document.getElementById("lang-en");
      const langBnBtn = document.getElementById("lang-bn");

      // Template Selectors
      const selectors = document.querySelectorAll(".template-selector");
      const templates = document.querySelectorAll("#poster-container > div");

      // Live Elements
      const headlineEls = document.querySelectorAll(".poster-headline-text");
      const categoryEls = document.querySelectorAll(".poster-category-text");
      const attributionEls = document.querySelectorAll(
        ".poster-attribution-text"
      );
      const brandEls = document.querySelectorAll(".poster-brand-text");
      const brandLogos = document.querySelectorAll(".poster-brand-logo");
      const canvases = document.querySelectorAll(".poster-image-canvas");

      // Styling
      const styleTag = document.createElement("style");
      document.head.appendChild(styleTag);

      // State
      let currentImage = null;
      let state = {
        zoom: 1,
        posX: 0,
        posY: 0,
        selectedTemplate: "headline",
        accentColor: "#3b82f6",
        lang: "en", // 'en' or 'bn'
      };

      // --- Initialization ---
      function init() {
        // Add listener to template selectors
        selectors.forEach((sel) => {
          sel.addEventListener("click", () =>
            switchTemplate(sel.dataset.template)
          );
        });

        // Input Listeners
        headlineInput.addEventListener("input", updateHeadline);
        categoryInput.addEventListener("input", updateCategory);
        attributionInput.addEventListener("input", updateAttribution);
        brandInput.addEventListener("input", updateBrand);

        // Color Listeners
        bgColorInput.addEventListener("input", updateColors);
        textColorInput.addEventListener("input", updateColors);
        accentColorInput.addEventListener("input", updateColors);
        highlightColorInput.addEventListener("input", updateHeadline); // Re-render regex

        // Regex Inputs
        highlightWordsInput.addEventListener("input", updateHeadline);
        underlineWordsInput.addEventListener("input", updateHeadline);

        // Typography Listeners
        textScaleInput.addEventListener("input", updateTypography);
        textLhInput.addEventListener("input", updateTypography);
        textSpacingInput.addEventListener("input", updateTypography);
        textXInput.addEventListener("input", updateTypography);
        textYInput.addEventListener("input", updateTypography);
        resetTypeBtn.addEventListener("click", resetTypography);

        // Language Listeners
        langEnBtn.addEventListener("click", () => switchLang("en"));
        langBnBtn.addEventListener("click", () => switchLang("bn"));

        // Image
        imageUpload.addEventListener("change", handleImageUpload);
        imageZoomInput.addEventListener("input", (e) => {
          state.zoom = parseFloat(e.target.value);
          drawImages();
        });
        imagePosXInput.addEventListener("input", (e) => {
          state.posX = parseInt(e.target.value);
          drawImages();
        });
        imagePosYInput.addEventListener("input", (e) => {
          state.posY = parseInt(e.target.value);
          drawImages();
        });

        // Reset & Download
        document
          .getElementById("reset-btn")
          .addEventListener("click", resetAll);
        document
          .getElementById("download-btn")
          .addEventListener("click", downloadPoster);

        // Initial Render
        drawDefaultPlaceholders();
        updateHeadline();
      }

      // --- Core Functions ---

      // Function for alignment buttons to call
      window.setTextAlign = function (align) {
        posterContainer.style.setProperty("--text-align", align);

        // Visual feedback on buttons
        document.querySelectorAll("[data-align]").forEach((btn) => {
          if (btn.dataset.align === align) {
            btn.classList.add("text-white", "bg-gray-700");
            btn.classList.remove("text-gray-400");
          } else {
            btn.classList.remove("text-white", "bg-gray-700");
            btn.classList.add("text-gray-400");
          }
        });
      };

      function updateTypography() {
        const scale = textScaleInput.value;
        const lh = textLhInput.value;
        const space = textSpacingInput.value;
        const x = textXInput.value;
        const y = textYInput.value;

        posterContainer.style.setProperty("--text-scale", scale);
        posterContainer.style.setProperty("--text-lh", lh);
        posterContainer.style.setProperty("--text-spacing", space + "em");
        posterContainer.style.setProperty("--text-x", x + "px");
        posterContainer.style.setProperty("--text-y", y + "px");
      }

      function resetTypography() {
        textScaleInput.value = 1;
        textLhInput.value = 1.2; // Visual reset, actually removing the prop is better
        textSpacingInput.value = 0;
        textXInput.value = 0;
        textYInput.value = 0;

        posterContainer.style.removeProperty("--text-scale");
        posterContainer.style.removeProperty("--text-lh");
        posterContainer.style.removeProperty("--text-spacing");
        posterContainer.style.removeProperty("--text-x");
        posterContainer.style.removeProperty("--text-y");
        posterContainer.style.removeProperty("--text-align");

        // Visual feedback on buttons
        document.querySelectorAll("[data-align]").forEach((btn) => {
          btn.classList.remove("text-white", "bg-gray-700");
          btn.classList.add("text-gray-400");
        });
      }

      function switchLang(lang) {
        state.lang = lang;

        if (lang === "bn") {
          // Activate Bangla
          document.body.classList.add("lang-bangla");

          // UI Styles
          langBnBtn.classList.remove("text-gray-400");
          langBnBtn.classList.add("bg-blue-600", "text-white");

          langEnBtn.classList.remove("bg-blue-600", "text-white");
          langEnBtn.classList.add("text-gray-400");

          // Defaults
          if (!headlineInput.value)
            headlineInput.placeholder = "আপনার শিরোনাম এখানে লিখুন...";
          if (!categoryInput.value)
            categoryInput.placeholder = "যেমন: ব্রেকিং নিউজ";

          // Update Brand Defaults
          document.querySelectorAll(".poster-brand-logo").forEach((el) => {
            if (el.textContent.includes("Daily"))
              el.textContent = el.textContent
                .replace("Daily", "ডেইলি")
                .replace("Origin", "অরিজিন");
            if (el.textContent.includes("The"))
              el.textContent = el.textContent.replace("The", "দ্য");
            if (el.textContent.includes("News"))
              el.textContent = el.textContent.replace("News", "নিউজ");
            if (el.textContent.includes("Match Day"))
              el.textContent = el.textContent.replace("Match Day", "খেলার দিন");
          });
        } else {
          // Activate English
          document.body.classList.remove("lang-bangla");

          // UI Styles
          langEnBtn.classList.remove("text-gray-400");
          langEnBtn.classList.add("bg-blue-600", "text-white");

          langBnBtn.classList.remove("bg-blue-600", "text-white");
          langBnBtn.classList.add("text-gray-400");

          // Defaults
          headlineInput.placeholder = "Enter your main headline...";
          categoryInput.placeholder = "e.g. BREAKING NEWS";

          // Revert Brand Defaults roughly (simple replace back)
          document.querySelectorAll(".poster-brand-logo").forEach((el) => {
            if (el.textContent.includes("ডেইলি"))
              el.textContent = el.textContent
                .replace("ডেইলি", "Daily")
                .replace("অরিজিন", "Origin");
            if (el.textContent.includes("দ্য"))
              el.textContent = el.textContent.replace("দ্য", "The");
          });
        }

        // Re-trigger updates to apply font classes
        updateHeadline();
      }

      function switchTemplate(templateName) {
        state.selectedTemplate = templateName;

        // UI Update
        selectors.forEach((s) => s.classList.remove("selected"));
        document
          .querySelector(`[data-template="${templateName}"]`)
          .classList.add("selected");

        // View Update
        templates.forEach((t) => t.classList.add("hidden"));
        const active = document.getElementById(`template-${templateName}`);
        if (active) {
          active.classList.remove("hidden");
          active.classList.add(
            templateName === "card"
              ? "flex"
              : templateName === "headline"
              ? "flex"
              : "block"
          );
          // Flex fix for specific templates
          if (templateName === "paper") active.style.display = "flex";
          if (templateName === "swiss") active.style.display = "flex";
        }

        // Redraw images because canvas size might change from display:none
        setTimeout(drawImages, 50);
      }

      function updateHeadline() {
        const rawText =
          headlineInput.value ||
          (state.lang === "bn" ? "আপনার শিরোনাম" : "TYPE YOUR HEADLINE");
        const hlColor = highlightColorInput.value;
        const txtColor = textColorInput.value;

        // Build CSS for Highlight
        styleTag.innerHTML = `
            .poster-headline-text .highlight { 
                background-color: ${hlColor}; 
                color: ${getContrastColor(hlColor)};
                padding: 0 0.2em;
                box-decoration-break: clone;
                -webkit-box-decoration-break: clone;
            }
            .poster-headline-text .underline {
                text-decoration: underline;
                text-decoration-color: ${state.accentColor};
                text-decoration-thickness: 0.1em;
                text-underline-offset: 0.1em;
            }
          `;

        // Process Text with Regex
        let html = escapeHtml(rawText);

        // Highlights
        const hlWords = highlightWordsInput.value
          .split(",")
          .map((w) => w.trim())
          .filter((w) => w);
        if (hlWords.length) {
          const regex = new RegExp(`(${hlWords.join("|")})`, "gi");
          html = html.replace(regex, '<span class="highlight">$1</span>');
        }

        // Underlines
        const ulWords = underlineWordsInput.value
          .split(",")
          .map((w) => w.trim())
          .filter((w) => w);
        if (ulWords.length) {
          const regex = new RegExp(`(${ulWords.join("|")})`, "gi");
          html = html.replace(regex, '<span class="underline">$1</span>');
        }

        headlineEls.forEach((el) => {
          el.innerHTML = html;
          el.style.color = txtColor;

          // Specific overrides per template
          if (el.closest("#template-broadcast")) {
            el.style.color = "#000000"; // Broadcast always black text on white
          }
          if (el.closest("#template-paper")) {
            el.style.color = "#1a1a1a";
          }
          if (
            el.closest("#template-headline") ||
            el.closest("#template-overlay") ||
            el.closest("#template-swiss")
          ) {
            el.style.color = txtColor;
          }
        });
      }

      function updateCategory() {
        const val = categoryInput.value.trim();
        categoryEls.forEach((el) => {
          if (!val) {
            el.classList.add("hidden");
          } else {
            el.classList.remove("hidden");
            el.innerText = val;
          }
        });
      }

      function updateAttribution() {
        const val = attributionInput.value.trim();
        attributionEls.forEach((el) => {
          if (!val) {
            el.classList.add("hidden");
          } else {
            el.classList.remove("hidden");
            // Formatting based on template
            if (el.closest("#template-quote")) el.innerText = `— ${val}`;
            else if (el.closest("#template-paper"))
              el.innerText =
                state.lang === "bn" ? `${val} দ্বারা` : `By ${val}`;
            else el.innerText = val;
          }
        });
      }

      function updateBrand() {
        const val = brandInput.value.trim();
        if (val) {
          brandLogos.forEach((l) => (l.style.display = "none"));
          brandEls.forEach((b) => {
            b.classList.remove("hidden");
            b.innerText = val;
          });
        } else {
          brandLogos.forEach((l) => (l.style.display = "flex")); // or block depending on styling
          brandEls.forEach((b) => b.classList.add("hidden"));
          // Fix for block-level logos
          document.querySelector(
            "#template-paper .poster-brand-logo"
          ).style.display = "block";
          document.querySelector(
            "#template-broadcast .poster-brand-logo"
          ).style.display = "block";
          document.querySelector(
            "#template-swiss .poster-brand-logo"
          ).style.display = "block";
        }
      }

      function updateColors() {
        state.accentColor = accentColorInput.value;
        const bg = bgColorInput.value;
        const txt = textColorInput.value;

        // Apply BG
        templates.forEach((t) => {
          // Paper template keeps its own bg
          if (
            t.id !== "template-paper" &&
            t.id !== "template-swiss" &&
            t.id !== "template-football"
          ) {
            t.style.backgroundColor = bg;
          }
          // Swiss uses accent as BG
          if (t.id === "template-swiss")
            t.style.backgroundColor = state.accentColor;
        });

        // Re-trigger headline to update underline color
        updateHeadline();

        // UI Element Colors
        document
          .querySelectorAll(".poster-logo-artisan")
          .forEach((el) => (el.style.color = state.accentColor));

        // specific elements
        const overlayLine = document.querySelector(
          "#template-overlay .bg-blue-500"
        );
        if (overlayLine) overlayLine.style.backgroundColor = state.accentColor;

        const broadcastBar = document.querySelector(
          "#template-broadcast .border-red-600"
        );
        if (broadcastBar) broadcastBar.style.borderColor = state.accentColor;
      }

      // --- Image Logic ---

      function handleImageUpload(e) {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (event) => {
          const img = new Image();
          img.onload = () => {
            currentImage = img;
            imageAdjustControls.classList.remove("hidden");
            drawImages();
          };
          img.src = event.target.result;
        };
        reader.readAsDataURL(file);
      }

      function drawImages() {
        canvases.forEach((canvas) => {
          const ctx = canvas.getContext("2d");
          // Ensure canvas matches display size (essential for high DPI look)
          const rect = canvas.getBoundingClientRect();
          canvas.width = rect.width * 2; // Retina scaling
          canvas.height = rect.height * 2;

          if (currentImage) {
            drawImageCover(
              ctx,
              currentImage,
              canvas.width,
              canvas.height,
              state.zoom,
              state.posX,
              state.posY
            );
          } else {
            drawDefaultPlaceholder(ctx, canvas.width, canvas.height);
          }
        });
      }

      function drawImageCover(ctx, img, cw, ch, zoom, px, py) {
        // Clear
        ctx.clearRect(0, 0, cw, ch);

        const imgRatio = img.width / img.height;
        const canvasRatio = cw / ch;

        let sw, sh; // Source width/height

        if (imgRatio > canvasRatio) {
          sh = img.height;
          sw = img.height * canvasRatio;
        } else {
          sw = img.width;
          sh = img.width / canvasRatio;
        }

        // Apply Zoom (crop area gets smaller)
        sw /= zoom;
        sh /= zoom;

        // Apply Pan
        let sx = (img.width - sw) / 2;
        let sy = (img.height - sh) / 2;

        // Pan limits
        const maxPanX = (img.width - sw) / 2;
        const maxPanY = (img.height - sh) / 2;

        sx += maxPanX * (px / 100);
        sy += maxPanY * (py / 100);

        ctx.drawImage(img, sx, sy, sw, sh, 0, 0, cw, ch);
      }

      function drawDefaultPlaceholder(ctx, w, h) {
        ctx.fillStyle = "#374151"; // gray-700
        ctx.fillRect(0, 0, w, h);
        ctx.fillStyle = "#4b5563"; // gray-600

        // Draw a pattern
        for (let i = 0; i < w; i += 40) {
          ctx.fillRect(i, 0, 2, h);
        }
      }

      function drawDefaultPlaceholders() {
        // Just run drawImages without an image loaded
        drawImages();
      }

      // --- Utilities ---
      function getContrastColor(hex) {
        const r = parseInt(hex.substr(1, 2), 16);
        const g = parseInt(hex.substr(3, 2), 16);
        const b = parseInt(hex.substr(5, 2), 16);
        const yiq = (r * 299 + g * 587 + b * 114) / 1000;
        return yiq >= 128 ? "black" : "white";
      }

      function escapeHtml(text) {
        return text
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      }

      function resetAll() {
        headlineInput.value = "";
        categoryInput.value = "";
        attributionInput.value = "";
        brandInput.value = "";
        imageUpload.value = "";
        currentImage = null;
        state = {
          zoom: 1,
          posX: 0,
          posY: 0,
          selectedTemplate: "headline",
          accentColor: "#3b82f6",
          lang: "en",
        };

        // Update UI
        imageAdjustControls.classList.add("hidden");
        imageZoomInput.value = 1;
        imagePosXInput.value = 0;
        imagePosYInput.value = 0;

        switchLang("en"); // Reset to English
        resetTypography();

        switchTemplate("headline");
        updateHeadline();
        updateCategory();
        updateAttribution();
        updateBrand();
        updateColors();
        drawDefaultPlaceholders();
      }

      function downloadPoster() {
        const loading = document.getElementById("loading-message");
        const active = document.getElementById(
          `template-${state.selectedTemplate}`
        );

        if (!active) return;

        loading.classList.remove("hidden");

        html2canvas(active, {
          scale: 2, // Export at 2x
          useCORS: true,
          backgroundColor: null, // Transparent logic handled by CSS
        }).then((canvas) => {
          const link = document.createElement("a");
          link.download = `publisher-suite-${Date.now()}.png`;
          link.href = canvas.toDataURL("image/png");
          link.click();
          loading.classList.add("hidden");
        });
      }

      // Run
      window.onload = init;
      window.onresize = drawImages;
    </script>
  </body>
</html>
